/***首页js***/
$(function(){
	//左边菜单下拉事件
	$(".menu-ul div").click(function(){
		 $(".menu-ul div").add(".a-title").removeClass("sel-menu");
		 $(this).next().stop().slideToggle("slow");
		 if($(this).next().height()==1){
		 	$(this).addClass("sel-menu");
		 }
	});

	//左边菜单点击事件
	$(".a-title").click(function(){
		$(".menu-ul div").add(".a-title").removeClass("sel-menu");
		$(this).addClass("sel-menu");
		var url=$(this).attr("url");
		var indexNum=1000;
		$(".right-count").find("iframe").hide();
		$(".right-tab").find("li").removeClass("sel-tabtitle");
		$(".right-count iframe").each(function(index){
			if($(this).attr("src")==url){
				indexNum=index;
				return false;
			}
		});
		if(indexNum<1000){//菜单已存在
			$(".tab-title").find("li").eq(indexNum).addClass("sel-tabtitle");
			$(".right-count").find("iframe").eq(indexNum).show();
			var tabLenght=0;
			$(".tab-title").find("li").each(function(index){
				if(index<=indexNum){
					tabLenght+=$(this).width()+14;
				}
			});
			if(tabLenght>$(".right-tab>div").width()){
				$(".tab-title").css("margin-left",0-tabLenght+$(".tab-div>div").width()+"px");
			}else{
				$(".tab-title").css("margin-left","0px");
			}
			return false;
		}
		$(".tab-title").append('<li class="sel-tabtitle">'+$(this).find("span").html()+'<img src="img/close-btn.png"/></li>');
		$(".right-count").append('<iframe frameborder="no" src="'+url+'"></iframe>');
		var tabLenght=0;
		$(".tab-title").find("li").each(function(){
			tabLenght+=$(this).width()+14;
		});
		if(tabLenght>$(".right-tab>div").width()){
			$(".tab-title").css("margin-left",0-tabLenght+$(".right-tab>div").width()+"px");
		}
		//顶部标签页点击事件
		$(".tab-title").find("li").unbind("click");
		$(".tab-title").find("li").click(function(){
			$(".tab-title").find("li").removeClass("sel-tabtitle");
			$(".right-count").find("iframe").hide();
			$(this).addClass("sel-tabtitle");
			$(".right-count").find("iframe").eq($(this).index()).show();
		});
		//关闭顶部标签页按钮
		$(".tab-title>li>img").unbind("click");
		$(".tab-title>li>img").click(function(){
			var tabNum=$(this).parent().index();
			if($(".right-count").find("iframe").eq(tabNum).css("display")!="none"){
				$(".tab-title").find("li").eq(tabNum-1).addClass("sel-tabtitle");
				$(".right-count").find("iframe").eq(tabNum-1).show();
			}
			$(this).parent().remove();
			$(".right-count").find("iframe").eq(tabNum).remove();
			var tabLenght=0;
			$(".tab-title").find("li").each(function(){
				tabLenght+=$(this).width()+14;
			});
			if(tabLenght<$(".tab-div>div").width()){
				$(".tab-title").css("margin-left","0px");
			}
		});
	});

	//标签页滑动按钮点击
	$(".right-tab>img").click(function(){
		var num=$(this).index();
		var tabLeft=parseInt($(".tab-title").css("margin-left").substring(0,$(".tab-title").css("margin-left").length-2));
		var tabLenght=0;
		$(".tab-title").find("li").each(function(){
			tabLenght+=$(this).width()+20;
		});
		if(tabLenght>$(".right-tab>div").width()){
			if(num==0){
				if(tabLeft+100>0){
					tabLeft=0;
				}else{
					tabLeft=tabLeft+25;
				}
			}else{
				if(tabLenght-$(".right-tab>div").width()-100<=0-tabLeft){
					tabLeft=0-tabLenght+$(".right-tab>div").width()-10;
				}else{
					tabLeft=tabLeft-25;
				}
			}
			$(".tab-title").css("margin-left",tabLeft+"px");
		}
	});
});